<!DOCTYPE html>
<html lang="mn">
  <head>
  <meta charset="utf-8">
  <meta name="generator" content="Hugo 0.121.1">

  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta http-equiv="Permissions-Policy" content="interest-cohort=()">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  
  <meta name="twitter:card" content="summary">
  <meta name="twitter:title" content="SIP нууц үг сэргээх - Ochko">
  <meta name="twitter:description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.">
  <meta name="twitter:site" content="https://ochko.github.io">
  <meta name="twitter:creator" content="L.Ochirkhuyag">
  <meta name="twitter:image" content="https://ochko.github.io/images/koen-stripe.jpg">

  
  <meta property="og:locale" content="">
  <meta property="og:type" content="article">
  <meta property="og:title" content="SIP нууц үг сэргээх - Ochko">
  <meta property="og:description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.">
  <meta property="og:url" content="https://ochko.github.io/tech/2012-10-sip-password-recovery/">
  <meta property="og:site_name" content="Ochko">
  <meta property="og:image" content="https://ochko.github.io/images/koen-stripe.jpg">

  <meta name="author" content="L.Ochirkhuyag">
  <meta name="description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.">

  <title>SIP нууц үг сэргээх :: Ochko</title>

  
  

  
  <link rel="stylesheet" href="https://ochko.github.io/main.ba77102aadc0da1e5595bb0f37d782a1cc4cc908013206d15ea55e9080a93054.css">

  <link rel="stylesheet" href="/katex/katex.min.css" media="print" onload="this.media='all';this.onload=null;">

  <link rel="stylesheet" href="/pagefind/pagefind-ui.css">
</head>


  <body class="antialiased">
    <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 min-h-screen flex flex-col">
      
      <header class="mb-8">
        <nav class="flex space-x-4" aria-label="Tabs">
          <a href="/"><img class="inline-block h-12 w-12 rounded-full ml-2 mr-6" src="https://ochko.github.io/images/koen-stripe.jpg" alt="L.Ochirkhuyag"></a>
          
          
          <a href="https://ochko.github.io/posts/" class="text-gray-500 hover:text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md">Personal Blog</a>
          
          <a href="https://ochko.github.io/tech/" class="bg-gray-100 text-gray-500 hover:text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md">Tech stuff</a>
          
          
        </nav>
      </header>
      

      <div class="flex-1 pt-10">
<article class="prose max-w-none">
  <h1>SIP нууц үг сэргээх</h1>
  <time class="text-sm text-right text-gray-600" datetime="2012-10-28 14:43:00 &#43;08">2012-10-28</time>
  <div class="pt-4">
    <p>G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.</p>
<h3 id="өгөгдөл-барьж-авах">Өгөгдөл барьж авах</h3>
<p>Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>$ tcpdump -n -i rl0 -w sip.dump src host 203.91.115.91 or dst host 203.91.115.91
</span></span></code></pre></div><p>Авсан sip.dump файлаа <a href="http://www.wireshark.org/">Wireshark</a> аар нээж ямархуу өгөгдөл байгааг харав. Мэдээж нууц үг гэхээр юм ил харагдсангүй. Жаахан судалвал <a href="http://en.wikipedia.org/wiki/Digest_access_authentication">Digest Access Authentication</a> гэдэг аргаар холбогдож байгааг мэдээд авлаа. Пакет дотроос хэрэглэгчийн нэр, сэрвэрийн uri, hash түлхүүр зэргийг олоод авлаа.</p>
<h3 id="нууц-үгийг-олох">Нууц үгийг олох</h3>
<p>Digest Access Authentication нь сэрвэрээс явуулсан түлхүүрийг ашиглаад hash түлхүүр үүсгэж явуулна. Сэрвэр тэр түлхүүрийг өөрийн үүсгэсэн түлхүүртэй харьцуулна, нууц үг сүлжээгээр хэзээ ч дамжихгүй юм. Миний нууц үг 6 оронтой тоо байсан гэдгийг бүүр түүрхэн санаж байгаа учраас <a href="http://en.wikipedia.org/wiki/Brute-force_attack">brute force attack</a> хийхэд маш боломжын юм. 1 сая хувилбар шалгана гэдэг бол хэдхэн секундэд л багтчих учраас хялбар <a href="http://pastie.org/5130265">ruby script</a> бичээд нууц үгээ сэргээчихлээ.</p>
<pre tabindex="0"><code>$ irb
&gt;&gt; load &#39;sip\_cracker.rb&#39;
&gt;&gt; sip = SipCracker.new(&#39;98989898&#39;, &#39;REGISTER&#39;,
        &#39;sip:203.91.203.91&#39;, &#39;&#39;,
        &#39;5a14e7431e75a6df28de476048e4cd3f&#39;,
        &#39;3b066b0a81044cb624990b0e4368d4b7&#39;)
&gt;&gt; sip.crack(6)
&gt;&gt; Password found: 123456
</code></pre><p>Хэрэв нууц үг тоо үсэг зэргийг агуулсан, нилээн урт байсан бол brute force хийхэд маш их хугацаа орж болох талтай. Ийм тохиолдолд С дээр бичих нь ч дээр байж мэднэ.</p>
<p><em>Сэрвэрийн хаяг, хэрэглэгчийн нэр, нууц үг болон түлхүүр зэрэг нь бодит өгөгдөл биш ;)</em></p>

  </div>
</article>

      </div>

      
<footer class="mt-12">
  
  <div class="flex flex-col md:flex-row md:justify-between -mx-2 pt-2 px-2 pb-6 border-t">
    <div class="md:mr-12 md:w-1/2">
      
      <a href="https://ochko.github.io/tech/2012-12-23-openssl/" class="block">
        <span class="block font-semibold text-gray-600">Previous</span>
        <span class="block">Файлыг нууцлаж хадгалах</span>
      </a>
      
    </div>
    <div class="md:text-right mt-4 md:mt-0">
      
      <a href="https://ochko.github.io/tech/2012-09-coder-mn/" class="block">
        <span class="block font-semibold text-gray-600">Next</span>
        <span class="block">Кодер сайтын 3 дахь удаагийн шинэчлэл</span>
      </a>
      
    </div>
  </div>
  
  <div class="text-xs text-center">&copy; 2006-2023 L.Ochirkhuyag</div>
</footer>

    </div>

    
    <script defer src="/katex/katex.min.js" ></script>
    <script defer src="/katex/auto-render.min.js" onload="renderMathInElement(document.body);"></script>
    
  </body>
</html>
