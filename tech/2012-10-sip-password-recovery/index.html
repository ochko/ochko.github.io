<!doctype html><html lang=mn><head><meta charset=utf-8><meta name=generator content="Hugo 0.81.0"><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=twitter:card content="summary"><meta name=twitter:title content="SIP нууц үг сэргээх - Ochko"><meta name=twitter:description content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах  Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав."><meta name=twitter:site content="https://ochko.github.io"><meta name=twitter:creator content="L.Ochirkhuyag"><meta name=twitter:image content="https://ochko.github.io/images/koen-stripe.jpg"><meta property="og:locale" content><meta property="og:type" content="article"><meta property="og:title" content="SIP нууц үг сэргээх - Ochko"><meta property="og:description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах  Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав."><meta property="og:url" content="https://ochko.github.io/tech/2012-10-sip-password-recovery/"><meta property="og:site_name" content="Ochko"><meta property="og:image" content="https://ochko.github.io/images/koen-stripe.jpg"><meta name=author content="L.Ochirkhuyag"><meta name=description content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах  Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав."><title>SIP нууц үг сэргээх :: Ochko</title><link rel=stylesheet href=https://ochko.github.io/main.21059bc571b5cff2448ffab38ba66bd8e3d381d17c16c7a0c81e95165f3b47e1.css></head><body class=antialiased><div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8 min-h-screen flex flex-col"><header class=mb-8><nav class="flex space-x-4" aria-label=Tabs><a href=/><img class="inline-block h-12 w-12 rounded-full ml-2 mr-6" src=https://ochko.github.io/images/koen-stripe.jpg alt=L.Ochirkhuyag></a>
<a href=https://ochko.github.io/posts/ class="text-gray-500 hover:text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md">Personal Blog</a>
<a href=https://ochko.github.io/tech/ class="bg-gray-100 text-gray-500 hover:text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md">Tech stuff</a></nav></header><div class="flex-1 pt-10"><article class="prose max-w-none"><div class="text-3xl font-serif">SIP нууц үг сэргээх</div><time class="text-sm text-gray-600" datetime="2012-10-28 14:43:00 +08">2012-10-28</time><div class=pt-4><p>G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.</p><h3 id=өгөгдөл-барьж-авах>Өгөгдөл барьж авах </h3><p>Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.</p><pre><code>$ tcpdump -n -i rl0 -w sip.dump src host 203.91.115.91 or dst host 203.91.115.91
</code></pre><p>Авсан sip.dump файлаа <a href=http://www.wireshark.org/>Wireshark</a> аар нээж ямархуу өгөгдөл байгааг харав. Мэдээж нууц үг гэхээр юм ил харагдсангүй. Жаахан судалвал <a href=http://en.wikipedia.org/wiki/Digest_access_authentication>Digest Access Authentication</a> гэдэг аргаар холбогдож байгааг мэдээд авлаа. Пакет дотроос хэрэглэгчийн нэр, сэрвэрийн uri, hash түлхүүр зэргийг олоод авлаа.</p><h3 id=нууц-үгийг-олох>Нууц үгийг олох*</h3><p>Digest Access Authentication нь сэрвэрээс явуулсан түлхүүрийг ашиглаад hash түлхүүр үүсгэж явуулна. Сэрвэр тэр түлхүүрийг өөрийн үүсгэсэн түлхүүртэй харьцуулна, нууц үг сүлжээгээр хэзээ ч дамжихгүй юм. Миний нууц үг 6 оронтой тоо байсан гэдгийг бүүр түүрхэн санаж байгаа учраас <a href=http://en.wikipedia.org/wiki/Brute-force_attack>brute force attack</a> хийхэд маш боломжын юм. 1 сая хувилбар шалгана гэдэг бол хэдхэн секундэд л багтчих учраас хялбар <a href=http://pastie.org/5130265>ruby script</a> бичээд нууц үгээ сэргээчихлээ.</p><pre><code>$ irb  
\# load 'sip\_cracker.rb'  
\# sip = SipCracker.new('98989898', 'REGISTER',   
        'sip:203.91.203.91', '',   
        '5a14e7431e75a6df28de476048e4cd3f',   
        '3b066b0a81044cb624990b0e4368d4b7')  
\# sip.crack(6)  
\# Password found: 123456  

</code></pre><p>Хэрэв нууц үг тоо үсэг зэргийг агуулсан, нилээн урт байсан бол brute force хийхэд маш их хугацаа орж болох талтай. Ийм тохиолдолд С дээр бичих нь ч дээр байж мэднэ.</p><p><em>* Жишээнүүдэд байгаа сэрвэрийн хаяг, хэрэглэгчийн нэр, нууц үг болон түлхүүр зэрэг нь бодит өгөгдөл биш ;)</em></p></div></article></div><footer class="mt-12 text-xs">&copy; 2006-2021 L.Ochirkhuyag</footer></div></body></html>