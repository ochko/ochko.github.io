<!doctype html>
<html lang="mn"><meta charset="utf-8">
<meta name="generator" content="Hugo 0.81.0" />

<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">


<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="SIP нууц үг сэргээх - Ochko&#39;s blog">
<meta name="twitter:description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах  Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.">
<meta name="twitter:site" content="http://blog.maahai.com/">
<meta name="twitter:creator" content="L.Ochirkhuyag">
<meta name="twitter:image" content="http://blog.maahai.com/images/avatar.jpg">


<meta property="og:locale" content="">
<meta property="og:type" content="article">
<meta property="og:title" content="SIP нууц үг сэргээх - Ochko&#39;s blog">
<meta property="og:description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах  Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.">
<meta property="og:url" content="http://blog.maahai.com/tech/2012-10-sip-password-recovery/">
<meta property="og:site_name" content="Ochko&#39;s blog">
<meta property="og:image" content="http://blog.maahai.com/images/avatar.jpg">

<meta name="author" content="L.Ochirkhuyag">
<meta name="description" content="G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.
Өгөгдөл барьж авах  Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.">

<title>SIP нууц үг сэргээх - Ochko&#39;s blog</title>








<link rel="stylesheet" href="http://blog.maahai.com/main.9facde066d35c5fb0565c92181bbbb86b525e039615832148c0b790ae5be871b.css">
<body class="antialiased">
      <div class="container mx-auto py-4 px-4 sm:px-6 lg:px-8"><div class="mb-8">
  <nav class="flex space-x-4" aria-label="Tabs">
    <img class="inline-block h-12 w-12 rounded-full ml-2 mr-6" src="http://blog.maahai.com/images/avatar.jpg" alt="L.Ochirkhuyag">

    <a href="#" class="text-gray-500 hover:text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md">
      Blog
    </a>
     <a href="#" class="bg-gray-100 text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md" aria-current="page">
    
      Tech
    </a>
    <a href="#" class="text-gray-500 hover:text-gray-700 px-3 my-2 py-2 font-medium text-sm rounded-md">
      About
    </a>
  </nav>
</div>
<div id="content">
<article class="prose max-w-none">
  <div class="text-3xl font-serif">SIP нууц үг сэргээх</div>
  <time class="text-gray-500" datetime="2012-10-28 14:43:00 &#43;08">2012-10-28</time>
<p>G-Mobile компаний интэрнэт утас гэдэг SIP утасны үйлчилгээг хэрэглэдэг. Жилийн өмнө эрх аваад утсан дээрээ суулгасан байсан юм. Өчигдөр гэрийн утсандаа холбох хэрэг гартал нууц үгээ мартчихаж. Утсан дээр бол нууц үг нь хадгалаатай байгаа боловч энкриплэгдчихсэн учраас ил харагддаггүй. Ингээд Монгол руу холбоо барьж нууц үгээ сэргээгдтэл өөрөө оролдож үзэхээр шийдэв.</p>
<h3 id="өгөгдөл-барьж-авах">Өгөгдөл барьж авах </h3>
<p>Утас маань гэрийн wifi аар интэрнэтэд холбогдсон байгаа бөгөөд рүүтэр дээрээ дараах командыг ашиллуулж пакет барьж авав.</p>
<pre><code>$ tcpdump -n -i rl0 -w sip.dump src host 203.91.115.91 or dst host 203.91.115.91
</code></pre><p>Авсан sip.dump файлаа <a href="http://www.wireshark.org/">Wireshark</a> аар нээж ямархуу өгөгдөл байгааг харав. Мэдээж нууц үг гэхээр юм ил харагдсангүй. Жаахан судалвал <a href="http://en.wikipedia.org/wiki/Digest_access_authentication">Digest Access Authentication</a> гэдэг аргаар холбогдож байгааг мэдээд авлаа. Пакет дотроос хэрэглэгчийн нэр, сэрвэрийн uri, hash түлхүүр зэргийг олоод авлаа.</p>
<h3 id="нууц-үгийг-олох">Нууц үгийг олох*</h3>
<p>Digest Access Authentication нь сэрвэрээс явуулсан түлхүүрийг ашиглаад hash түлхүүр үүсгэж явуулна. Сэрвэр тэр түлхүүрийг өөрийн үүсгэсэн түлхүүртэй харьцуулна, нууц үг сүлжээгээр хэзээ ч дамжихгүй юм. Миний нууц үг 6 оронтой тоо байсан гэдгийг бүүр түүрхэн санаж байгаа учраас <a href="http://en.wikipedia.org/wiki/Brute-force_attack">brute force attack</a> хийхэд маш боломжын юм. 1 сая хувилбар шалгана гэдэг бол хэдхэн секундэд л багтчих учраас хялбар <a href="http://pastie.org/5130265">ruby script</a> бичээд нууц үгээ сэргээчихлээ.</p>
<pre><code>$ irb  
\# load 'sip\_cracker.rb'  
\# sip = SipCracker.new('98989898', 'REGISTER',   
        'sip:203.91.203.91', '',   
        '5a14e7431e75a6df28de476048e4cd3f',   
        '3b066b0a81044cb624990b0e4368d4b7')  
\# sip.crack(6)  
\# Password found: 123456  

</code></pre><p>Хэрэв нууц үг тоо үсэг зэргийг агуулсан, нилээн урт байсан бол brute force хийхэд маш их хугацаа орж болох талтай. Ийм тохиолдолд С дээр бичих нь ч дээр байж мэднэ.</p>
<p><em>* Жишээнүүдэд байгаа сэрвэрийн хаяг, хэрэглэгчийн нэр, нууц үг болон түлхүүр зэрэг нь бодит өгөгдөл биш ;)</em></p>

<article>

        </div><footer class="mt-20 text-sm">&copy; 2006-2021 L.Ochirkhuyag</footer>
</div>
    </body>
</html>
